---
# tasks file for packetbeat

- name: clean tmp directory
  file: 
    path: "{{ packetbeat_build_path }}"
    state: absent

- name: create build tmp directories
  file: path={{ item }} state=directory mode=0777
  with_items:
    - "{{ packetbeat_build_path }}"

- name: copy dockerfile
  template: 
    src: "{{ item }}" 
    dest: "{{ packetbeat_build_path }}"
  with_items:
    - Dockerfile
    - packetbeat-entrypoint.sh
    - packetbeat.yml

- name: build docker image
  docker_image:
      name: "pelk-packetbeat"
      path: "{{ packetbeat_build_path }}"
      state: build
